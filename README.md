# style_transfer_bot

Данный проект является финальным для курса по CV от МФТИ.

### Задача
Написать телеграм-бота, который будет получать на вход две картинки, а возвращать одну, которая будет результатом применения стиля одной исходной ко второй.

### Описание

Для оптимальной работы было настроено разрешение входной и выходной картинки 200x200, это было сделано для ускорения работы, так как на сервере нет GPU. Это позволяет получать результат примерно за 2-3 минуты.

Были подобраны следующие параметры модели:
- num_steps=200
- style_weight=100000
- learning_rate=1

Через каждые 10 шагов модель сохраняет изображение и его значение лосса, при проходе всех 200 шагов, выбирает лучшее изображение (то, у которого лосс минимален среди всех сохраненных) и отправляет его обратно пользователю в разрешении 200x200.

### Ссылки

Архитектура модели была взята отсюда:
 https://pytorch.org/tutorials/advanced/neural_style_tutorial.html

Для демонстрации код также залит на HuggingFace, где упакован в docker-контейнер:
 https://huggingface.co/spaces/MrSashkaman/StyleTransfer

Ссылка на самого бота в Telegram:
 https://t.me/af_style_transfer_bot
 
 P.S. К сожалению, на бесплатном тарифе на Huggingface бот падает через полчаса после запуска, и его приходится перезаупскать вручную. Я могу перезапустить его, если вы со мной свяжитесь, ссылка на мой телеграм: https://t.me/Mr_Sashkaman 
 P.P.S На крайний случай, прикрепляю ссылку на видео с демонстрацией работы: https://www.youtube.com/watch?v=oZtrgQLhNVY&ab_channel=%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B0%D0%BD%D0%B4%D1%80%D0%A4%D0%B5%D0%B4%D0%BE%D1%80%D0%BE%D0%B2








